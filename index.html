
<!DOCTYPE html>
<html lang="en">
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <meta charset="utf-8">
  <style>
  body {
    background-color: black;
    font-family: "helvetica";
    height: 100%;
  }

  svg {
    cursor: pointer;
    width: 100%;
    height: 900px;
  }

  circle {
    fill: none;
  }

  </style>
  <script src="https://cdn.firebase.com/js/client/2.2.7/firebase.js"></script>
  <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
</head>

<body>

  <script type="text/javascript">

  var colorR;
  var colorG;
  var colorB;
  $( document ).ready(function() {
      colorR = Math.floor((Math.random() * 155) + 100);
      colorG = Math.floor((Math.random() * 155) + 100);
      colorB = Math.floor((Math.random() * 155) + 100);
  });
  var r = 400;
  var ref = new Firebase('https://dankripplz.firebaseio.com')

  var svg = d3.select("body")
  .append("svg");



  var positionLabel = svg.append("text")
  .attr("x", 10)
  .attr("y", 30);

  svg.on("click", function () { //<-D
    var dashLength = Math.floor((Math.random() * 20));
    var spaceLength = Math.floor((Math.random() * 20));
    var position = d3.mouse(svg.node());
    createRipple(position[0], position[1], colorR, colorG, colorB, dashLength, spaceLength)
    ref.push({x: position[0], y: position[1], r: colorR, g: colorG, b: colorB, dl: dashLength, sl:spaceLength})
  });



  ref.on('child_added', function(snapshot){
    alert('tr')
    createRipple(snapshot.child('x').val(), snapshot.child('y').val(), snapshot.child('r').val(), snapshot.child('g').val(), snapshot.child('b').val(), snapshot.child('dl').val(), snapshot.child('sl').val())
  })

  function createRipple(ex, ey, r, g, b, dl, sl){
    for (var i = 1; i < 5; ++i) {


      var circle = svg.append("circle")
      .style('stroke', 'rgb(' + r + ',' + g + ',' + b + ')')
      .attr("cx", ex)
      .attr("cy", ey)
      .attr("r", 0)
      .attr("stroke-dasharray", dl + "," + sl)
      .style("stroke-width", 5 / (i))
      .transition()
      .delay(Math.pow(i, 2.5) * 50)
      .duration(2000)
      .ease('quad-in')
      .attr("r", r)
      .style("stroke-opacity", 0)
      .each("end", function () {
        d3.select(this).remove();
      });
    }
  }
  </script>
</body>
</html>
